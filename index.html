<!DOCTYPE html>
<html lang="en">
<head>
     <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journaly</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=mail" />

</head>
<body>

   <div class="login-box" id="login-box">
        <form id="loginForm">
            <div class="login-header">
                <h2>Sign In</h2>
            </div>
            
            <div class="input-box">
                <span class="icon"></span>
                <input type="email" id="email" required>
                <label>Email</label>
            </div>
            
            <div class="input-box">
                <span class="icon"></span>
                <input type="password" id="password" required>
                <label>Password</label>
            </div>
            
            <div class="remember-forgot">
                <label><input type="checkbox">Remember me</label>
                <a href="/passwordreset.html">Forgot Password?</a>
            </div>
            
            <button type="submit" id="signInBtn">Sign In</button>
            <button type="button" id="googleSignInBtn">Sign In with Google</button>
            
            <div class="register-link">
                <p>Don't have an account? <a href="/register.html">Register</a></p>
            </div>
            
            <div id="errorMessage" style="color: red; margin-top: 10px; display: none;"></div>
        </form>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, sendPasswordResetEmail } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyAWmlQgPu34uIDOsBBy4J3bdPB4QFue1iI",
            authDomain: "journal-d2fcd.firebaseapp.com",
            projectId: "journal-d2fcd",
            storageBucket: "journal-d2fcd.firebasestorage.app",
            messagingSenderId: "279588365736",
            appId: "1:279588365736:web:47c252930b9fad19fd299d",
            measurementId: "G-6QHND3BWFR"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        document.addEventListener('DOMContentLoaded', () => {
            const resetForm = document.getElementById('resetForm');
            const emailInput = document.getElementById('email');
            const errorDiv = document.getElementById('errorMessage');

            function showError(message) {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
                alert(message);
            }

            function hideError() {
                errorDiv.style.display = 'none';
            }

            resetForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                hideError();

                const email = emailInput.value.trim();

                if (!email) {
                    showError('Please enter your email');
                    return;
                }

                try {
                    await sendPasswordResetEmail(auth, email);
                    alert('Password reset email sent! Check your inbox.');
                    setTimeout(() => {
                        window.location.href = '/index.html';
                    }, 2000);
                } catch (error) {
                    console.error("‚ùå Reset error:", error.code);
                    
                    let errorMessage = 'Failed to send reset email: ';
                    switch (error.code) {
                        case 'auth/invalid-email':
                            errorMessage += 'Invalid email address.';
                            break;
                        case 'auth/user-not-found':
                            errorMessage += 'No account with this email.';
                            break;
                        default:
                            errorMessage += error.message;
                    }
                    showError(errorMessage);
                }
            });
        });
    </script>

    
</body>
</html>